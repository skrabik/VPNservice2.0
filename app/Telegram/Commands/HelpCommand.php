<?php

namespace App\Telegram\Commands;

use App\Models\Customer;
use App\Models\TelegramCommandLog;
use Telegram\Bot\Laravel\Facades\Telegram;
use Telegram\Bot\Objects\Update;

class HelpCommand extends BaseCommand
{
    public function __construct(Update $update, Customer $customer, array $params)
    {
        parent::__construct($update, $customer, $params);
    }

    public function handle(): void
    {
        TelegramCommandLog::create([
            'customer_id' => $this->customer->id,
            'command_name' => 'Ð’Ñ‹Ð·Ð²Ð°Ð» ÐºÐ¾Ð¼Ð°Ð½Ð´Ñƒ /help',
            'action' => 'Ð’Ñ‹Ð·Ð²Ð°Ð» ÐºÐ¾Ð¼Ð°Ð½Ð´Ñƒ /help',
        ]);

        $message = "ðŸ¤– <b>VPN Ð‘Ð¾Ñ‚ - ÐŸÐ¾Ð¼Ð¾Ñ‰ÑŒ</b>\n\n".
                  "Ð”Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹Ðµ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹:\n\n".
                  "ðŸ”‘ /key - ÐŸÐ¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ ÐºÐ»ÑŽÑ‡ VPN\n".
                  "ðŸ“± /instructions - Ð˜Ð½ÑÑ‚Ñ€ÑƒÐºÑ†Ð¸Ð¸ Ð¿Ð¾ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸ÑŽ Ðº VPN\n".
                  "ðŸ“Š /status - ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ ÑÑ‚Ð°Ñ‚ÑƒÑ Ð¿Ð¾Ð´Ð¿Ð¸ÑÐºÐ¸\n".
                  "ðŸ’³ /buy - ÐšÑƒÐ¿Ð¸Ñ‚ÑŒ Ð¿Ð¾Ð´Ð¿Ð¸ÑÐºÑƒ\n".
                  "ðŸŽ /promo - Ð’Ð²ÐµÑÑ‚Ð¸ Ð¿Ñ€Ð¾Ð¼Ð¾ÐºÐ¾Ð´\n".
                  "ðŸ“ /support - Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ñ‚Ð¸ÐºÐµÑ‚ Ð² Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÑƒ\n".
                  'Ð•ÑÐ»Ð¸ Ñƒ Ð²Ð°Ñ Ð²Ð¾Ð·Ð½Ð¸ÐºÐ»Ð¸ Ð²Ð¾Ð¿Ñ€Ð¾ÑÑ‹, Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñƒ /support.';

        $keyboard = [
            ['ðŸ”‘ ÐŸÐ¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ ÐºÐ»ÑŽÑ‡', 'ðŸ“± Ð˜Ð½ÑÑ‚Ñ€ÑƒÐºÑ†Ð¸Ð¸ Ð¿Ð¾ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸ÑŽ'],
            ['ðŸ’³ ÐžÐ¿Ð»Ð°Ñ‚Ð¸Ñ‚ÑŒ Ð¿Ð¾Ð´Ð¿Ð¸ÑÐºÑƒ', 'ðŸ“Š Ð¡Ñ‚Ð°Ñ‚ÑƒÑ Ð¿Ð¾Ð´Ð¿Ð¸ÑÐºÐ¸'],
            ['ðŸŽ Ð’Ð²ÐµÑÑ‚Ð¸ Ð¿Ñ€Ð¾Ð¼Ð¾ÐºÐ¾Ð´', 'ðŸ“ ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ°'],
            ['â“ ÐŸÐ¾Ð¼Ð¾Ñ‰ÑŒ'],
        ];

        Telegram::sendMessage([
            'chat_id' => $this->customer->telegram_id,
            'text' => $message,
            'parse_mode' => 'HTML',
            'reply_markup' => json_encode([
                'keyboard' => $keyboard,
                'resize_keyboard' => true,
                'one_time_keyboard' => false,
            ]),
        ]);
    }
}
